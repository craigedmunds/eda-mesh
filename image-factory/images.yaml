# Image Factory Enrollment Registry
# Add images here to enroll them in automated rebuild tracking
# The system will discover dependencies and maintain state in state/ directory
#

- name: backstage
  registry: ghcr.io
  repository: craigedmunds/backstage
  source:
    provider: github  # github or gitlab
    repo: craigedmunds/argocd-eda  # Source repo (happens to be this repo)
    branch: main
    dockerfile: backstage/app/packages/backend/Dockerfile
    # For GitHub:
    workflow: backstage.yml
    # For GitLab:
    # pipeline: .gitlab-ci.yml
    # job: build-backstage
  rebuildDelay: 7d    # Wait 7 days after base image update
  autoRebuild: true   # Automatically trigger rebuilds

- name: uv
  registry: ghcr.io
  repository: craigedmunds/uv
  source:
    provider: github
    repo: craigedmunds/argocd-eda
    branch: main
    dockerfile: apps/uv/Dockerfile
    workflow: uv.yml
  rebuildDelay: 7d
  autoRebuild: true
  # Real-world updates configuration for Requirement 18
  # updates:
  #   - repo: craigedmunds/argocd-eda
  #     path: image-factory/cdk8s/images.yaml
  #     type: yaml-update
  #     # Will update the hardcoded image: ghcr.io/craigedmunds/uv line
  #   - repo: craigedmunds/argocd-eda
  #     path: eda/kustomize/mesh/backstage-catalog-api/kustomization.yaml
  #     type: kustomize-set-image
  #     # Will update kustomize image references

- name: e2e-test-runner
  registry: ghcr.io
  repository: craigedmunds/e2e-test-runner
  source:
    provider: github
    repo: craigedmunds/argocd-eda
    branch: main
    dockerfile: apps/e2e-test-runner/Dockerfile
    workflow: e2e-runner.yml
  rebuildDelay: 7d
  autoRebuild: true

- name: code-server-dev
  registry: ghcr.io
  repository: craigedmunds/code-server-dev
  source:
    provider: github
    repo: craigedmunds/argocd-eda
    branch: main
    dockerfile: platform/kustomize/seed/supporting-applications/code-server/Dockerfile
    workflow: code-server-dev.yml
  rebuildDelay: 7d
  autoRebuild: true
