name: Build and Push UV Image

on:
  push:
    branches:
      - main
      - feature/backstage-events
    paths:
      - 'apps/uv/**'
      - '.github/workflows/uv.yml'
  
  workflow_dispatch:
    inputs:
      version_bump:
        description: 'Version bump type'
        required: false
        default: 'patch'
        type: choice
        options:
          - patch
          - minor
          - major

jobs:
  build-and-push:
    uses: ./.github/workflows/reusable-docker-build.yml
    with:
      app_name: 'UV'
      image_name: 'craigedmunds/uv'
      dockerfile: 'apps/uv/Dockerfile'
      context: 'apps/uv'
      version_file: 'apps/uv/VERSION'
      version_type: 'file'
      # No pre-build script needed for UV
      # Pass through version_bump input if present
      version_bump: ${{ inputs.version_bump || 'patch' }}
    secrets: inherit
